#include <stdio.h>
#include "platform.h"
namespace GNET
{
	int _monster_exp [] = {
		5     ,
		7     ,
		10    ,
		12    ,
		14    ,
		17    ,
		19    ,
		21    ,
		23    ,
		26    ,
		28    ,
		30    ,
		39    ,
		48    ,
		57    ,
		63    ,
		69    ,
		74    ,
		80    ,
		85    ,
		91    ,
		96    ,
		101   ,
		108   ,
		116   ,
		123   ,
		130   ,
		154   ,
		178   ,
		202   ,
		212   ,
		223   ,
		233   ,
		243   ,
		260   ,
		277   ,
		294   ,
		311   ,
		329   ,
		348   ,
		366   ,
		384   ,
		422   ,
		460   ,
		498   ,
		517   ,
		535   ,
		554   ,
		572   ,
		596   ,
		619   ,
		643   ,
		666   ,
		706   ,
		745   ,
		785   ,
		824   ,
		897   ,
		969   ,
		1042  ,
		1103  ,
		1163  ,
		1224  ,
		1284  ,
		1360  ,
		1436  ,
		1511  ,
		1587  ,
		1694  ,
		1801  ,
		1907  ,
		2014  ,
		2349  ,
		2683  ,
		3018  ,
		3147  ,
		3275  ,
		3404  ,
		3532  ,
		3664  ,
		3797  ,
		3929  ,
		4061  ,
		4289  ,
		4516  ,
		4744  ,
		4971  ,
		5219  ,
		5468  ,
		5716  ,
		5931  ,
		6145  ,
		6360  ,
		6574  ,
		6821  ,
		7067  ,
		7314  ,
		7560  ,
		7843  ,
		8127  ,
		8410  ,
		8693  ,
		9128  ,
		9562  ,
		9997  ,
		10372 ,
		10747 ,
		11122 ,
		11497 ,
		11928 ,
		12360 ,
		12791 ,
		13222 ,
		13718 ,
		14214 ,
		14709 ,
		15205 ,
		15965 ,
		16726 ,
		17486 ,
		18142 ,
		18797 ,
		19453 ,
		20108 ,
		20862 ,
		21617 ,
		22371 ,
		23125 ,
		23992 ,
		24859 ,
		25726 ,
		26593 ,
		28683 ,
		30773 ,
		32863 ,
		34096 ,
		35328 ,
		36561 ,
		37793 ,
		42089 ,
		46384 ,
		50680 ,
		53214 ,
		55748 ,
		58282 ,
		64110 ,
		69938 ,
		73435 ,
		76932 ,
		80429 
	};

	float _exp_factor[] = {
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0001,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.0005,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.001,
		0.01,
		0.01,
		0.01,
		0.01,
		0.01,
		0.01,
		0.05,
		0.05,
		0.05,
		0.05,
		0.05,
		0.05,
		0.3,
		0.3,
		0.4,
		0.4,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1,
		1
	};

	int GetMonsterExp(int level)
	{
		return _monster_exp[(level-1)%150];
	}

	float GetExpFactor(int self_level, int peer_level)
	{
		return _exp_factor[(peer_level-self_level+149)%299];
	}

	double GetExpShare(int64_t exp, int self_level, int peer_level, float factor)
	{
		if(self_level<1)
			self_level = 1;
		if(self_level>150)
			self_level = 150;
		if(peer_level<1)
			peer_level = 1;
		if(peer_level>150)
			peer_level = 150;

		double e =  (double)GetMonsterExp(self_level)*factor/3.0*exp/GetMonsterExp(peer_level)
			*GetExpFactor(self_level,peer_level);
		return e;
	}

};
