	public:
		Octets nonce;
		unsigned int version;
		Octets edition;
		char algo;
		int64_t server_attr;
		enum { PROTOCOL_TYPE = PROTOCOL_CHALLENGE };
	public:
		Challenge() { type = PROTOCOL_CHALLENGE; }
		Challenge(void*) : Protocol(PROTOCOL_CHALLENGE) { }
		Challenge (const Octets& l_nonce,unsigned int l_version,const Octets& l_edition,
			char l_algo = 0,int64_t l_server_attr = 0)
			 : nonce(l_nonce),version(l_version),edition(l_edition)
			,algo(l_algo),server_attr(l_server_attr)
		{
			type = PROTOCOL_CHALLENGE;
		}

		Challenge(const Challenge &rhs)
			: Protocol(rhs),nonce(rhs.nonce),version(rhs.version),edition(rhs.edition)
			,algo(rhs.algo),server_attr(rhs.server_attr) { }

		GNET::Protocol *Clone() const { return new Challenge(*this); }

		OctetsStream& marshal(OctetsStream & os) const
		{
			os << nonce;
			os << version;
			os << edition;
			os << algo;
			os << server_attr;
			return os;
		}

		const OctetsStream& unmarshal(const OctetsStream &os)
		{
			os >> nonce;
			os >> version;
			os >> edition;
			os >> algo;
			os >> server_attr;
			return os;
		}

		int PriorPolicy( ) const { return 101; }

		bool SizePolicy(size_t size) const { return size <= 128; }
